"use strict";const e=require("../common/vendor.js");getApp();const s={saveImage:function(n,t){let o=this;e.index.authorize({scope:"scope.writePhotosAlbum",success:()=>{o.downLoadImg(n,t)},fail:()=>{e.index.getSetting({success:i=>{i.authSetting["scope.writePhotosAlbum"]||o.isAuth()}})}})},downLoadImg:function(n,t){e.index.showLoading({title:"加载中"}),e.index.downloadFile({url:n,success:o=>{e.index.hideLoading(),o.statusCode===200?t==!1?e.index.saveImageToPhotosAlbum({filePath:o.tempFilePath,success:function(){e.index.showToast({title:"已保存到相册",icon:"none"})},fail:function(){e.index.showToast({title:"保存失败，请稍后重试",icon:"none"})}}):e.index.saveVideoToPhotosAlbum({filePath:o.tempFilePath,success:function(){e.index.showToast({title:"已保存到相册",icon:"none"})},fail:function(){e.index.showToast({title:"保存失败，请稍后重试",icon:"none"})}}):e.index.showToast({title:"资源格式错误，请联系管理员",icon:"none"})},fail:o=>{e.index.showToast({title:"保存失败，请联系管理员",icon:"none"})}})},isAuth:function(){e.index.showModal({content:"由于您还没有允许保存图片到您相册里,无法进行保存,请点击确定允许授权",success:n=>{n.confirm&&e.index.openSetting({success:t=>{console.log(t.authSetting)}})}})}};exports.download=s;
