"use strict";const i=require("../../common/vendor.js"),n=require("../../utils/urlUtil.js");require("../../utils/request.js");require("../../utils/cache.js");const m={data(){return{imageURL:"",promotionId:""}},onLoad(e){this.promotionId=e.id},methods:{getImageUrl(e){return n.urlUtil.getImgUrlNotSize(e)},onClockUpload(){i.index.chooseMedia({count:1,mediaType:["image"],sourceType:["album","camera"],maxDuration:30,camera:"back",sizeType:["compressed"],success:e=>{if(e&&e.tempFiles&&e.tempFiles.length>0){let o=e.tempFiles[0];this.uploadImage(o.tempFilePath)}}})},uploadImage(e){this.$api.uploadFile(e).then(o=>{this.imageURL=o.url}).catch(o=>{this.imageURL=""})},submitPromotion(){if(!this.imageURL||this.imageURL===""){this.$msg("请选择推广照片");return}this.$api.submitPromotion(this.promotionId,this.imageURL).then(e=>{e&&(e.code_type=="Qrcode"&&e.qrcode&&e.qrcode!=""?i.index.redirectTo({url:"/pages/award/result?result="+encodeURIComponent(JSON.stringify(e))}):e.code_type=="Number"&&e.code&&e.code!=""?i.index.redirectTo({url:"/pages/award/result?result="+encodeURIComponent(JSON.stringify(e))}):this.$msg("获取提交结果失败"))}).catch(e=>{})},onLoadImageError(e){this.imageURL=""}}};Array||i.resolveComponent("uni-icons")();const c=()=>"../../uni_modules/uni-icons/components/uni-icons/uni-icons.js";Math||c();function s(e,o,u,d,t,r){return i.e({a:t.imageURL&&t.imageURL.length>0},t.imageURL&&t.imageURL.length>0?{b:r.getImageUrl(t.imageURL),c:i.o((...a)=>r.onLoadImageError&&r.onLoadImageError(...a))}:{d:i.p({type:"camera-filled",size:"80rpx",color:"rgba(51, 49, 52, .25)"})},{e:i.o(a=>r.onClockUpload()),f:i.o((...a)=>r.submitPromotion&&r.submitPromotion(...a))})}const l=i._export_sfc(m,[["render",s],["__scopeId","data-v-4d32f24a"],["__file","D:/HBuilderProjects/house/pages/award/prove.vue"]]);wx.createPage(l);
