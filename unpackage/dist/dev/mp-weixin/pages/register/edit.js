"use strict";const s=require("../../common/vendor.js"),c=require("../../utils/cache.js"),p={data(){return{type:1,userCard:null,userInfo:null,companyName:"",companyData:[]}},onLoad(e){const{type:t}=e;this.type=t,s.index.setNavigationBarTitle({title:t==1?"我的名片":"编辑名片"})},onShow(){this.fetchUserCard(),this.fetchUserInfo(),this.fetchUserCompany()},methods:{showCompanyPicker(){this.$refs.popup.open()},closeCompanyPicker(){this.$refs.popup.close()},onCompanyItemClick(e){this.companyName=e,this.closeCompanyPicker()},getDisplayInputValue(e){return e==="name"&&this.userCard&&this.userCard.name?this.userCard.name:e==="phone"?this.userInfo&&this.userInfo.phone?this.userInfo.phone:"":e==="company"&&this.userCard&&this.userCard.company?this.userCard.company:e==="address"&&this.userCard&&this.userCard.address?this.userCard.address:""},fetchUserInfo(){let e=c.cache.getToken();e&&e!=""?this.$api.fetchUserInfo().then(t=>{this.userInfo=t}).catch(t=>{}):this.userInfo=null},fetchUserCard(){this.$api.fetchUserCard().then(e=>{this.userCard=e,console.log("fetchUserCard: "+JSON.stringify(e)),e&&e.company&&(this.companyName=e.company)}).catch(e=>{})},fetchUserCompany(){this.$api.fetchUserCompany().then(e=>{this.companyData=e}).catch(e=>{})},submitUserCard(e){let t=e.detail.value.name,o=e.detail.value.phone,i=e.detail.value.company,r=e.detail.value.address;if(t.length===0){this.$msg("请输入联系人");return}this.$api.submitUserCard(t,o,i,r).then(n=>{this.$msg("提交成功"),s.index.navigateBack()}).catch(n=>{})}}};if(!Array){const e=s.resolveComponent("uni-icons"),t=s.resolveComponent("uni-popup");(e+t)()}const u=()=>"../../uni_modules/uni-icons/components/uni-icons/uni-icons.js",h=()=>"../../uni_modules/uni-popup/components/uni-popup/uni-popup.js";Math||(u+h)();function m(e,t,o,i,r,n){return{a:n.getDisplayInputValue("name"),b:n.getDisplayInputValue("phone"),c:s.o(a=>n.showCompanyPicker()),d:r.companyName,e:s.o(a=>r.companyName=a.detail.value),f:n.getDisplayInputValue("address"),g:s.t(r.type==1?"确认":"保存并使用"),h:s.o((...a)=>n.submitUserCard&&n.submitUserCard(...a)),i:s.p({type:"closeempty",size:"20",color:"#999999"}),j:s.o((...a)=>n.closeCompanyPicker&&n.closeCompanyPicker(...a)),k:s.f(r.companyData,(a,l,y)=>({a:s.t(a),b:s.o(f=>n.onCompanyItemClick(a))})),l:s.sr("popup","36de54db-0"),m:s.p({type:"bottom"})}}const d=s._export_sfc(p,[["render",m],["__scopeId","data-v-36de54db"],["__file","D:/HBuilderProjects/house/pages/register/edit.vue"]]);wx.createPage(d);
