"use strict";const s=require("../../common/vendor.js"),d=require("../../utils/cache.js"),h={data(){return{type:1,userCard:null,userInfo:null}},onLoad(e){const{type:r}=e;this.type=r,s.index.setNavigationBarTitle({title:r==1?"我的名片":"编辑名片"})},onShow(){this.fetchUserCard(),this.fetchUserInfo()},methods:{getDisplayInputValue(e){return e==="name"&&this.userCard&&this.userCard.name?this.userCard.name:e==="phone"?this.userInfo&&this.userInfo.phone?this.userInfo.phone:"":e==="company"&&this.userCard&&this.userCard.company?this.userCard.company:e==="address"&&this.userCard&&this.userCard.address?this.userCard.address:""},fetchUserInfo(){let e=d.cache.getToken();e&&e!=""?this.$api.fetchUserInfo().then(r=>{this.userInfo=r}).catch(r=>{}):this.userInfo=null},fetchUserCard(){this.$api.fetchUserCard().then(e=>{this.userCard=e,console.log("fetchUserCard result: "+JSON.stringify(e))}).catch(e=>{console.log("fetchUserCard err: "+JSON.stringify(e))})},submitUserCard(e){let r=e.detail.value.name,n=e.detail.value.phone,i=e.detail.value.company,a=e.detail.value.address;if(r.length===0){this.$msg("请输入联系人");return}this.$api.submitUserCard(r,n,i,a).then(t=>{this.$msg("提交成功"),s.index.navigateBack()}).catch(t=>{})}}};function c(e,r,n,i,a,t){return{a:t.getDisplayInputValue("name"),b:t.getDisplayInputValue("phone"),c:t.getDisplayInputValue("company"),d:t.getDisplayInputValue("address"),e:s.t(a.type==1?"确认":"保存并使用"),f:s.o((...u)=>t.submitUserCard&&t.submitUserCard(...u))}}const l=s._export_sfc(h,[["render",c],["__scopeId","data-v-36de54db"],["__file","D:/HBuilderProjects/house/pages/register/edit.vue"]]);wx.createPage(l);
