"use strict";const e=require("../../../common/vendor.js"),a=require("../../../utils/cache.js"),g={data(){return{currentBuilding:null,showChannelPicker:!1,channelData:[],selectedChannel:null,buildingData:[],customPhone:"",customNote:"",isSubmitting:!1}},onLoad(){this.currentBuilding=a.cache.getCurrentBuilding()},methods:{onClickBuilding(){this.$refs.buildingPicker.open()},closeBuildingSelected(){this.$refs.buildingPicker.close()},onClickChennel(){this.$refs.channelPicker.open(),this.fetchChannel()},closeChannelSelected(){this.$refs.channelPicker.close()},onChannelSelected(t){this.selectedChannel=t,this.closeChannelSelected()},onClickSubmit(t){let l=t.detail.value.phone,c=t.detail.value.note;if(!this.currentBuilding){this.$msg("请选择楼盘");return}if(!this.selectedChannel){this.$msg("请选择渠道");return}if(!l||l==""){this.$msg("请输入客户电话");return}if(l.length!=11){this.$msg("请输入正确的客户电话");return}let o=this;e.index.showModal({title:"提示",content:"请确认登记信息，是否确认提交？",success:function(n){n.confirm?o.submitInfo(l,c):n.cancel}})},bindCurrentBuilding(t){this.currentBuilding=t,this.closeBuildingSelected()},fetchChannel(){this.$staffApi.fetchChannel().then(t=>{this.$refs.pagingChannel.complete(t)}).catch(t=>{})},fetchBuilding(t,l){this.$staffApi.fetchBuildingList(t,l).then(c=>{this.customPhone="",this.$refs.paging.complete(c)}).catch(c=>{})},submitInfo(t,l){this.isSubmitting=!0,this.$staffApi.submitCustomerCheck(this.currentBuilding.id,this.selectedChannel.id,t,l).then(c=>{this.$msg("提交成功"),this.customPhone="",this.customNote="",this.isSubmitting=!1}).catch(c=>{this.isSubmitting=!1})}}};if(!Array){const t=e.resolveComponent("uni-icons"),l=e.resolveComponent("z-paging"),c=e.resolveComponent("uni-popup");(t+l+c)()}const m=()=>"../../../uni_modules/uni-icons/components/uni-icons/uni-icons.js",f=()=>"../../../uni_modules/z-paging/components/z-paging/z-paging.js",d=()=>"../../../uni_modules/uni-popup/components/uni-popup/uni-popup.js";Math||(m+f+d)();function p(t,l,c,o,n,s){return e.e({a:n.currentBuilding},n.currentBuilding?{b:n.currentBuilding.name}:{},{c:e.p({type:"right",size:"18",color:"#999999"}),d:e.o(i=>s.onClickBuilding()),e:n.selectedChannel},n.selectedChannel?{f:n.selectedChannel.name}:{},{g:e.p({type:"right",size:"18",color:"#999999"}),h:e.o(i=>s.onClickChennel()),i:n.customPhone,j:e.o(i=>n.customPhone=i.detail.value),k:n.customNote,l:e.o(i=>n.customNote=i.detail.value),m:n.isSubmitting},n.isSubmitting?{}:{},{n:e.o((...i)=>s.onClickSubmit&&s.onClickSubmit(...i)),o:e.p({type:"closeempty",size:"20",color:"#999999"}),p:e.o((...i)=>s.closeChannelSelected&&s.closeChannelSelected(...i)),q:e.f(n.channelData,(i,u,h)=>({a:e.t(i.name),b:e.o(r=>s.onChannelSelected(i))})),r:e.sr("pagingChannel","8b9f9631-3,8b9f9631-2"),s:e.o(s.fetchChannel),t:e.o(s.fetchChannel),v:e.o(i=>n.channelData=i),w:e.p({fixed:!1,["refresher-only"]:!0,modelValue:n.channelData}),x:e.sr("channelPicker","8b9f9631-2"),y:e.p({type:"bottom"}),z:e.p({type:"closeempty",size:"20",color:"#999999"}),A:e.o((...i)=>s.closeBuildingSelected&&s.closeBuildingSelected(...i)),B:e.f(n.buildingData,(i,u,h)=>({a:e.t(i.name),b:e.o(r=>s.bindCurrentBuilding(i))})),C:e.sr("paging","8b9f9631-6,8b9f9631-5"),D:e.o(s.fetchBuilding),E:e.o(i=>n.buildingData=i),F:e.p({fixed:!1,modelValue:n.buildingData}),G:e.sr("buildingPicker","8b9f9631-5"),H:e.p({type:"bottom"})})}const C=e._export_sfc(g,[["render",p],["__scopeId","data-v-8b9f9631"],["__file","D:/HBuilderProjects/house/pages/staff/qr/check_in.vue"]]);wx.createPage(C);
