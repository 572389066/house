"use strict";const i=require("../../../common/vendor.js"),c=require("../../../utils/cache.js"),u={data(){return{currentBuilding:null,subscribeOff:!0,subscribeTmplIds:["p_BGDxGD2wY3kyfbB4sTSNdSevo4RRZeUy2uFSkj4aQ"]}},onLoad(){this.fetchBuilding()},onShow(){},methods:{subscribeMessage(){i.index.requestSubscribeMessage({tmplIds:this.subscribeTmplIds,success:e=>{console.log("subscribeMessage:  success--->>"+JSON.stringify(e))},fail:e=>{console.log("subscribeMessage:  fail--->>"+JSON.stringify(e))}})},showSubscribeModal(){i.index.showModal({title:"提示",content:"你尚未开启接收订阅消息，去开启？",success:e=>{e.confirm?this.openSetting():e.cancel}})},openSetting(){i.index.openSetting({withSubscriptions:!0,success:e=>{}})},bindCurrentBuilding(e){this.currentBuilding=e,c.cache.saveCurrentBuilding(this.currentBuilding)},onClickBuilding(){i.index.navigateTo({url:"/pages/staff/building/picker",events:{onDateResult:e=>{e.data&&this.bindCurrentBuilding(e.data)}}})},fetchBuilding(){this.$staffApi.fetchBuildingList(1,1).then(e=>{!this.currentBuilding&&e&&e.length>0&&this.bindCurrentBuilding(e[0])}).catch(e=>{})},loginOut(){i.index.showModal({title:"提示",content:"是否退出登录?",success:e=>{e.confirm?(c.cache.saveStaffToken(""),i.index.redirectTo({url:"/pages/staff/login/login"})):e.cancel}})}}};if(!Array){const e=i.resolveComponent("uni-icons"),t=i.resolveComponent("uni-nav-bar");(e+t)()}const o=()=>"../../../uni_modules/uni-icons/components/uni-icons/uni-icons.js",a=()=>"../../../uni_modules/uni-nav-bar/components/uni-nav-bar/uni-nav-bar.js";Math||(o+a)();function l(e,t,f,g,n,s){return i.e({a:n.currentBuilding},n.currentBuilding?{b:i.t(n.currentBuilding.name)}:{},{c:i.p({type:"right",size:"16",color:"#030303"}),d:i.o(s.onClickBuilding),e:i.p({["left-width"]:"300rpx",statusBar:"true"}),f:n.subscribeOff},n.subscribeOff?{g:i.p({type:"right",color:"#ffffff",size:"28rpx"}),h:i.o(r=>s.subscribeMessage())}:{},{i:i.o(r=>s.loginOut())})}const d=i._export_sfc(u,[["render",l],["__scopeId","data-v-5bbb43aa"],["__file","D:/HBuilderProjects/house/pages/staff/index/index.vue"]]);wx.createPage(d);
