"use strict";const t=require("../../common/vendor.js"),o=require("../../utils/cache.js"),i=require("../../utils/download.js"),e=require("../../utils/urlUtil.js"),n=require("../../utils/clipboard.js");require("../../utils/request.js");const s={data:()=>({promotionId:"",promotionDetail:null,videoData:[]}),onLoad(t){this.promotionId=t.id,this.fetchPromotionDetail()},onShareAppMessage(t){return this.promotionDetail?this.$shareAward(this.promotionId,this.promotionDetail.title):this.$shareIndex()},methods:{goupload(){this.checkLogin()&&t.index.navigateTo({url:"/pages/award/prove?id="+this.promotionId})},fetchPromotionDetail(){this.$api.fetchPromotionDetail(this.promotionId).then((t=>{this.promotionDetail=t,this.getVideo()})).catch((t=>{}))},getVideo(){if(this.promotionDetail&&this.promotionDetail.detail&&""!=this.promotionDetail.detail){let t=[];this.promotionDetail.detail.replace(/<video [^>]*src=['"]([^'"]+)[^>]*>/,(function(o,i){t.push(i)})),this.videoData=t}},onClickDownload(){let t=this.$refs.article.imgList,o=[];if(t&&t.length>0)for(var n=0;n<t.length;n++){let i=t[n];i&&""!=i&&o.push(i)}if(this.videoData&&this.videoData.length>0)for(n=0;n<this.videoData.length;n++){let t=this.videoData[n];t&&""!=t&&o.push(t)}if(0!=o.length)for(n=0;n<o.length;n++){let t=o[n];i.download.saveImage(t,e.urlUtil.isVideo(t))}else this.$msg("未找到图片/视频资源")},onClickCopy(){let t=this.$refs.article.getText();n.copyContent(t),this.$msg("复制成功")},checkLogin(){let i=o.cache.getToken();return!(!i||""==i)||(t.index.navigateTo({url:"/pages/login/login"}),!1)}}};if(!Array){(t.resolveComponent("uni-icons")+t.resolveComponent("mp-html"))()}Math||((()=>"../../uni_modules/uni-icons/components/uni-icons/uni-icons.js")+(()=>"../../uni_modules/mp-html/components/mp-html/mp-html.js"))();const l=t._export_sfc(s,[["render",function(o,i,e,n,s,l){return{a:t.p({type:"info",size:"30rpx",color:"#E09A5B"}),b:t.t(s.promotionDetail.title),c:t.sr("article","26451bcc-1"),d:t.p({content:s.promotionDetail.detail}),e:t.o((t=>l.onClickDownload())),f:t.o((t=>l.onClickCopy())),g:t.o(((...t)=>l.goupload&&l.goupload(...t)))}}],["__scopeId","data-v-26451bcc"]]);s.__runtimeHooks=2,wx.createPage(l);
