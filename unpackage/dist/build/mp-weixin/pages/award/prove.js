"use strict";const e=require("../../common/vendor.js"),o=require("../../utils/urlUtil.js");require("../../utils/request.js"),require("../../utils/cache.js");const i={data:()=>({imageURL:"",promotionId:""}),onLoad(e){this.promotionId=e.id},methods:{getImageUrl:e=>o.urlUtil.getImgUrlNotSize(e),onClockUpload(){e.index.chooseMedia({count:1,mediaType:["image"],sourceType:["album","camera"],maxDuration:30,camera:"back",sizeType:["compressed"],success:e=>{if(e&&e.tempFiles&&e.tempFiles.length>0){let o=e.tempFiles[0];this.uploadImage(o.tempFilePath)}}})},uploadImage(e){this.$api.uploadFile(e).then((e=>{this.imageURL=e.url})).catch((e=>{this.imageURL=""}))},submitPromotion(){this.imageURL&&""!==this.imageURL?this.$api.submitPromotion(this.promotionId,this.imageURL).then((o=>{o&&("Qrcode"==o.code_type&&o.qrcode&&""!=o.qrcode||"Number"==o.code_type&&o.code&&""!=o.code?e.index.redirectTo({url:"/pages/award/result?result="+encodeURIComponent(JSON.stringify(o))}):this.$msg("获取提交结果失败"))})).catch((e=>{})):this.$msg("请选择推广照片")},onLoadImageError(e){this.imageURL=""}}};if(!Array){e.resolveComponent("uni-icons")()}Math;const t=e._export_sfc(i,[["render",function(o,i,t,r,a,s){return e.e({a:a.imageURL&&a.imageURL.length>0},a.imageURL&&a.imageURL.length>0?{b:s.getImageUrl(a.imageURL),c:e.o(((...e)=>s.onLoadImageError&&s.onLoadImageError(...e)))}:{d:e.p({type:"camera-filled",size:"80rpx",color:"rgba(51, 49, 52, .25)"})},{e:e.o((e=>s.onClockUpload())),f:e.o(((...e)=>s.submitPromotion&&s.submitPromotion(...e)))})}],["__scopeId","data-v-6a721648"]]);wx.createPage(t);
