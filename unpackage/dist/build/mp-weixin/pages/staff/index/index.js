"use strict";const i=require("../../../common/vendor.js"),e=require("../../../utils/cache.js"),n={data:()=>({currentBuilding:null,subscribeOff:!0,subscribeTmplIds:["p_BGDxGD2wY3kyfbB4sTSNdSevo4RRZeUy2uFSkj4aQ"]}),onLoad(){this.fetchBuilding()},onShow(){},methods:{subscribeMessage(){i.index.requestSubscribeMessage({tmplIds:this.subscribeTmplIds,success:i=>{},fail:i=>{}})},showSubscribeModal(){i.index.showModal({title:"提示",content:"你尚未开启接收订阅消息，去开启？",success:i=>{i.confirm?this.openSetting():i.cancel}})},openSetting(){i.index.openSetting({withSubscriptions:!0,success:i=>{}})},bindCurrentBuilding(i){this.currentBuilding=i,e.cache.saveCurrentBuilding(this.currentBuilding)},onClickBuilding(){i.index.navigateTo({url:"/pages/staff/building/picker",events:{onDateResult:i=>{i.data&&this.bindCurrentBuilding(i.data)}}})},fetchBuilding(){this.$staffApi.fetchBuildingList(1,1).then((i=>{!this.currentBuilding&&i&&i.length>0&&this.bindCurrentBuilding(i[0])})).catch((i=>{}))},loginOut(){i.index.showModal({title:"提示",content:"是否退出登录?",success:n=>{n.confirm?(e.cache.saveStaffToken(""),i.index.redirectTo({url:"/pages/staff/login/login"})):n.cancel}})}}};if(!Array){(i.resolveComponent("uni-icons")+i.resolveComponent("uni-nav-bar"))()}Math||((()=>"../../../uni_modules/uni-icons/components/uni-icons/uni-icons.js")+(()=>"../../../uni_modules/uni-nav-bar/components/uni-nav-bar/uni-nav-bar.js"))();const s=i._export_sfc(n,[["render",function(e,n,s,t,u,r){return i.e({a:u.currentBuilding},u.currentBuilding?{b:i.t(u.currentBuilding.name)}:{},{c:i.p({type:"right",size:"16",color:"#030303"}),d:i.o(r.onClickBuilding),e:i.p({"left-width":"300rpx",statusBar:"true"}),f:u.subscribeOff},u.subscribeOff?{g:i.p({type:"right",color:"#ffffff",size:"28rpx"}),h:i.o((i=>r.subscribeMessage()))}:{},{i:i.o((i=>r.loginOut()))})}],["__scopeId","data-v-81d82a9c"]]);wx.createPage(s);
