"use strict";const e=require("../../../common/vendor.js"),i=require("../../../utils/cache.js"),n={data:()=>({currentBuilding:null,subscribeOff:!0,subscribeTmplIds:["p_BGDxGD2wY3kyfbB4sTSNdSevo4RRZeUy2uFSkj4aQ"]}),onLoad(){this.fetchBuilding()},onShow(){},methods:{subscribeMessage(){e.index.requestSubscribeMessage({tmplIds:this.subscribeTmplIds,success:e=>{console.log("subscribeMessage:  success---\x3e>"+JSON.stringify(e))},fail:e=>{console.log("subscribeMessage:  fail---\x3e>"+JSON.stringify(e))}})},showSubscribeModal(){e.index.showModal({title:"提示",content:"你尚未开启接收订阅消息，去开启？",success:e=>{e.confirm?this.openSetting():e.cancel}})},openSetting(){e.index.openSetting({withSubscriptions:!0,success:e=>{}})},bindCurrentBuilding(e){this.currentBuilding=e,i.cache.saveCurrentBuilding(this.currentBuilding)},onClickBuilding(){e.index.navigateTo({url:"/pages/staff/building/picker",events:{onDateResult:e=>{e.data&&this.bindCurrentBuilding(e.data)}}})},fetchBuilding(){this.$staffApi.fetchBuildingList(1,1).then((e=>{!this.currentBuilding&&e&&e.length>0&&this.bindCurrentBuilding(e[0])})).catch((e=>{}))},loginOut(){e.index.showModal({title:"提示",content:"是否退出登录?",success:n=>{n.confirm?(i.cache.saveStaffToken(""),e.index.redirectTo({url:"/pages/staff/login/login"})):n.cancel}})}}};if(!Array){(e.resolveComponent("uni-icons")+e.resolveComponent("uni-nav-bar"))()}Math||((()=>"../../../uni_modules/uni-icons/components/uni-icons/uni-icons.js")+(()=>"../../../uni_modules/uni-nav-bar/components/uni-nav-bar/uni-nav-bar.js"))();const s=e._export_sfc(n,[["render",function(i,n,s,t,u,r){return e.e({a:u.currentBuilding},u.currentBuilding?{b:e.t(u.currentBuilding.name)}:{},{c:e.p({type:"right",size:"16",color:"#030303"}),d:e.o(r.onClickBuilding),e:e.p({"left-width":"300rpx",statusBar:"true"}),f:u.subscribeOff},u.subscribeOff?{g:e.p({type:"right",color:"#ffffff",size:"28rpx"}),h:e.o((e=>r.subscribeMessage()))}:{},{i:e.o((e=>r.loginOut()))})}],["__scopeId","data-v-7b7a8661"]]);wx.createPage(s);
