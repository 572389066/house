"use strict";const e=require("../../../common/vendor.js"),n=require("../../../utils/cache.js"),i={data:()=>({currentBuilding:null,showChannelPicker:!1,channelData:[],selectedChannel:null,buildingData:[],customPhone:"",customNote:""}),onLoad(){this.currentBuilding=n.cache.getCurrentBuilding()},methods:{onClickBuilding(){this.$refs.buildingPicker.open()},closeBuildingSelected(){this.$refs.buildingPicker.close()},onClickChennel(){this.$refs.channelPicker.open(),this.fetchChannel()},closeChannelSelected(){this.$refs.channelPicker.close()},onChannelSelected(e){this.selectedChannel=e,this.closeChannelSelected()},onClickSubmit(n){let i=n.detail.value.phone,t=n.detail.value.note;if(!this.currentBuilding)return void this.$msg("请选择楼盘");if(!this.selectedChannel)return void this.$msg("请选择渠道");if(!i||""==i)return void this.$msg("请输入客户电话");if(11!=i.length)return void this.$msg("请输入正确的客户电话");let l=this;e.index.showModal({title:"提示",content:"请确认登记信息，是否确认提交？",success:function(e){e.confirm?l.submitInfo(i,t):e.cancel}})},bindCurrentBuilding(e){this.currentBuilding=e,this.closeBuildingSelected()},fetchChannel(){this.$staffApi.fetchChannel().then((e=>{this.$refs.pagingChannel.complete(e)})).catch((e=>{}))},fetchBuilding(e,n){this.$staffApi.fetchBuildingList(e,n).then((e=>{this.customPhone="",this.$refs.paging.complete(e)})).catch((e=>{}))},submitInfo(e,n){this.$staffApi.submitCustomerCheck(this.currentBuilding.id,this.selectedChannel.id,e,n).then((e=>{this.$msg("提交成功"),this.customPhone="",this.customNote=""})).catch((e=>{}))}}};if(!Array){(e.resolveComponent("uni-icons")+e.resolveComponent("z-paging")+e.resolveComponent("uni-popup"))()}Math||((()=>"../../../uni_modules/uni-icons/components/uni-icons/uni-icons.js")+(()=>"../../../uni_modules/z-paging/components/z-paging/z-paging.js")+(()=>"../../../uni_modules/uni-popup/components/uni-popup/uni-popup.js"))();const t=e._export_sfc(i,[["render",function(n,i,t,l,o,s){return e.e({a:o.currentBuilding},o.currentBuilding?{b:o.currentBuilding.name}:{},{c:e.p({type:"right",size:"18",color:"#999999"}),d:e.o((e=>s.onClickBuilding())),e:o.selectedChannel},o.selectedChannel?{f:o.selectedChannel.name}:{},{g:e.p({type:"right",size:"18",color:"#999999"}),h:e.o((e=>s.onClickChennel())),i:o.customPhone,j:e.o((e=>o.customPhone=e.detail.value)),k:o.customNote,l:e.o((e=>o.customNote=e.detail.value)),m:e.o(((...e)=>s.onClickSubmit&&s.onClickSubmit(...e))),n:e.p({type:"closeempty",size:"20",color:"#999999"}),o:e.o(((...e)=>s.closeChannelSelected&&s.closeChannelSelected(...e))),p:e.f(o.channelData,((n,i,t)=>({a:e.t(n.name),b:e.o((e=>s.onChannelSelected(n)))}))),q:e.sr("pagingChannel","e3f0583a-3,e3f0583a-2"),r:e.o(s.fetchChannel),s:e.o(s.fetchChannel),t:e.o((e=>o.channelData=e)),v:e.p({fixed:!1,"refresher-only":!0,modelValue:o.channelData}),w:e.sr("channelPicker","e3f0583a-2"),x:e.p({type:"bottom"}),y:e.p({type:"closeempty",size:"20",color:"#999999"}),z:e.o(((...e)=>s.closeBuildingSelected&&s.closeBuildingSelected(...e))),A:e.f(o.buildingData,((n,i,t)=>({a:e.t(n.name),b:e.o((e=>s.bindCurrentBuilding(n)))}))),B:e.sr("paging","e3f0583a-6,e3f0583a-5"),C:e.o(s.fetchBuilding),D:e.o((e=>o.buildingData=e)),E:e.p({fixed:!1,modelValue:o.buildingData}),F:e.sr("buildingPicker","e3f0583a-5"),G:e.p({type:"bottom"})})}],["__scopeId","data-v-e3f0583a"]]);wx.createPage(t);
