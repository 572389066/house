import{a6 as e,o,c as a,w as t,i as s,a as i,d as r,f as m,e as l}from"./index.50f83746.js";import{_ as c}from"./uni-icons.3d233546.js";import{r as n}from"./uni-app.es.c352a98c.js";import{u as d}from"./urlUtil.7c805a33.js";import{_ as u}from"./_plugin-vue_export-helper.cdc0426e.js";const p=u({data:()=>({imageURL:"",promotionId:""}),onLoad(e){this.promotionId=e.id},methods:{getImageUrl:e=>d.getImgUrlNotSize(e),onClockUpload(){uni.chooseMedia({count:1,mediaType:["image"],sourceType:["album","camera"],maxDuration:30,camera:"back",sizeType:["compressed"],success:e=>{if(e&&e.tempFiles&&e.tempFiles.length>0){let o=e.tempFiles[0];this.uploadImage(o.tempFilePath)}}})},uploadImage(e){this.$api.uploadFile(e).then((e=>{this.imageURL=e.url})).catch((e=>{this.imageURL=""}))},submitPromotion(){this.imageURL&&""!==this.imageURL?this.$api.submitPromotion(this.promotionId,this.imageURL).then((o=>{o&&("Qrcode"==o.code_type&&o.qrcode&&""!=o.qrcode||"Number"==o.code_type&&o.code&&""!=o.code?e({url:"/pages/award/result?result="+encodeURIComponent(JSON.stringify(o))}):this.$msg("获取提交结果失败"))})).catch((e=>{})):this.$msg("请选择推广照片")},onLoadImageError(e){this.imageURL=""}}},[["render",function(e,d,u,p,g,h){const f=s,U=m,_=n(l("uni-icons"),c);return o(),a(f,{class:"prove"},{default:t((()=>[i(f,{class:"cont"},{default:t((()=>[i(f,{class:"title"},{default:t((()=>[r("推广照片")])),_:1}),i(f,{class:"box",onClick:d[0]||(d[0]=e=>h.onClockUpload())},{default:t((()=>[g.imageURL&&g.imageURL.length>0?(o(),a(U,{key:0,src:h.getImageUrl(g.imageURL),mode:"heightFix",onError:h.onLoadImageError},null,8,["src","onError"])):(o(),a(f,{key:1,class:"font"},{default:t((()=>[i(_,{type:"camera-filled",size:"80rpx",color:"rgba(51, 49, 52, .25)"}),i(f,null,{default:t((()=>[r("上传推广凭证/截图")])),_:1})])),_:1}))])),_:1})])),_:1}),i(f,{class:"common_bottom",onClick:h.submitPromotion},{default:t((()=>[i(f,null,{default:t((()=>[r("立即上传")])),_:1})])),_:1},8,["onClick"])])),_:1})}],["__scopeId","data-v-6a721648"]]);export{p as default};
